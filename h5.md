# h5 Täysin Laillinen Sertifikaatti

## x) Lue/katso ja tiivistä. 

### OWASP 2021: OWASP Top 10:2021

#### A01:2021 – Broken Access Control (IDOR ja path traversal ovat osa tätä)

https://owasp.org/Top10/A01_2021-Broken_Access_Control/

-	Pääsynhallinnalla varmistetaan, että käyttäjällä on oikeus vain sallittuun tietoon.
-	Pääsynhallintaa voidaan kiertää URL-muokkauksilla, sovellustilan manipuloinnilla tai API-pyyntöjen väärinkäytöllä.
-	Käyttäjille tulee määritellä mihin tietoon heillä on pääsy ja oletuksena sulkea pääsy muuhun kuin julkiseen tietoon.

#### A10:2021 – Server-Side Request Forgery (SSRF)

https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/

-	Verkkosovellus sallii käyttäjän syöttää URL-osoitteen esimerkiksi datan hakemista varten ilman validointia, että onko syötetty URL sallittu tai turvallinen.
-	Hyökkääjä voi esimerkiksi porttiskannata sisäisiä palvelimia tai päästä käsiksi paikallisiin tiedostoihin tai sisäisiin palveluihin.

### PortSwigget Academy:

#### Insecure direct object references (IDOR)

https://portswigger.net/web-security/access-control/idor

-	Sovellus käyttää käyttäjän syöttämää tietoa suoraan objektien käsittelemiseen.
-	Esimerkiksi osoite kentässä muokataan kohtaa, jossa ilmoitetaan customer_number.
-	Esimerkiksi osoitekenttää voidaan muokata kasvattamalla juoksevaa numerointia.

#### Path traversal

https://portswigger.net/web-security/file-path-traversal

-	Hyökkääjä voi lukea ja/tai kirjoittaa tiedostoihin palvelimella.
-	Sovelluksen koodin ja datan, taustajärjestelmien kirjautumistiedot ja arkaluonteiset käyttöjärjestelmätiedostot.
-	**../**: siirtyminen yksi hakemistotaso ylöspäin.
-	**../../../**: siirrytään sovelluksen juurihakemistoon 
-	Windowsissa: ../ tai ..\

#### Server-side template injection

https://portswigger.net/web-security/server-side-template-injection

-	Käyttäjän syöte yhdistetään suoraan malliin sen sijaan, että se siirrettäisiin malliin datana.
-	Nämä haavoittuvuudet jäävät usein huomaamatta, koska ne eivät ole ilmeisiä, ellei niitä etsitä aktiivisesti.
-	${{<%[%'"}}%\

#### Server-side request forgery (SSRF)

https://portswigger.net/web-security/ssrf

-	Hyökkääjä voi saada palvelinpuolen sovelluksen tekemään pyyntöjä tahattomiin kohteisiin.
-	Palvelimilla sovellus pakotetaan tekemään HTTP-pyyntö takaisin palvelimelle, joka ylläpitää sovellusta, käyttämällä sen loopback-verkkoliittymää.

#### Cross-site scripting

https://portswigger.net/web-security/cross-site-scripting

-	Hyökkääjälle esiintyy toisena käyttäjänä ja suorittaa kaikki ne toimet, joihin käyttäjä on oikeutettu, ja päästä käsiksi käyttäjän tietoihin. 
-	Jos käyttäjällä on sovelluksessa korkeat oikeudet niin hyökkääjä voi saada täyden hallinnan sovelluksen toiminnallisuudesta ja tiedoista.
-	alert(),  print()

## a) Totally Legit Sertificate. 

Asenna OWASP ZAP, generoi CA-sertifikaatti ja asenna se selaimeesi. 
Laita ZAP proxyksi selaimeesi. 
Laita ZAP sieppaamaan myös kuvat, niitä tarvitaan tämän kerran kotitehtävissä. 
Osoita, että hakupyynnöt ilmestyvät ZAP:n käyttöliittymään. (Ei toimine localhost:lla ilman Foxyproxya)

## b) Kettumaista. 

Asenna "FoxyProxy Standard" Firefox Addon, ja lisää ZAP proxyksi siihen. 
Käytä FoxyProxyn "Patterns" -toimintoa, niin että vain valitsemasi weppisivut ohjataan Proxyyn. (Läksyssä ohjataan varmaankin PortSwigger Labs ja localhost.)
    
## PortSwigger Labs. 

Ratkaise tehtävät. Selitä ratkaisusi: mitä palvelimella tapahtuu, mitä eri osat tekevät, miten hyökkäys löytyi, mistä vika johtuu. 
Kannattaa käyttää ZAPia, vaikka malliratkaisut käyttävät harjoitusten tekijän maksullista ohjelmaa. 
Malliratkaisun kopioiminen ZAP:n tai selaimeen ei ole vastaus tehtävään, vaan ratkaisu ja haavoittuvuuden etsiminen on selitettävä ja perusteltava.

### Insecure Direct Object Reference (IDOR)

### c) Insecure direct object references

https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references

### Path traversal

### d) File path traversal, simple case

            https://portswigger.net/web-security/file-path-traversal/lab-simple
            
### e) File path traversal, traversal sequences blocked with absolute path bypass

https://portswigger.net/web-security/file-path-traversal/lab-absolute-path-bypass

### f) File path traversal, traversal sequences stripped non-recursively
        Server Side Template Injection (SSTI)

### g) Server-side template injection with information disclosure via user-supplied objects (Tämä on merkitty hieman vaikeammaksi, jätä viimeiseksi jos näyttää hankalalta)
        Server Side Request Forgery (SSRF)


### h) Basic SSRF against the local server
        Cross Site Scripting (XSS)
            i) Reflected XSS into HTML context with nothing encoded
            j) Stored XSS into HTML context with nothing encoded

## k) Asenna pencode ja muunna sillä jokin merkkijono (encode a string).

## l) Vapaaehtoinen: Mitmproxy. Asenna MitmProxy. Esittele sitä terminaalissa (TUI). Ota TLS-purku käyttöön. Poimi historiasta hakupyyntö, muokkaa sitä ja lähetä uudelleen.

## m) Vapaaehtoinen: Ratkaise lisää PortSwigger Labs -tehtäviä. Kannattaa tehdä helpoimmat "Apprentice" -tason tehtävät ensin.
